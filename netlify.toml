# Simple build configuration
[build]
  command = "cp netlify-frontend-package.json package.json && npm install --no-audit --no-fund && npm run build && cd netlify/functions && npm install"
  publish = "dist"
  ignore_requirements_txt = true
  environment = { NODE_VERSION = "20", PYTHON_ENABLED = "false" }
  functions = "netlify/functions"

# Plugin to install function dependencies
[[plugins]]
  package = "@netlify/plugin-functions-install-core"

# Redirect API requests to the backend
[[redirects]]
  from = "/api/*"
  to = "https://newsapi.org/:splat"
  status = 200

# Redirect API requests to the backend
[[redirects]]
  from = "/api/*"
  to = "https://api.akrunanalyticscorp.com/api/:splat"
  status = 200
  force = true

# Support SPA routing
[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200
